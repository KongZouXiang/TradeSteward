<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/../css/style.css" type="text/css">
    <link rel="stylesheet" href="/../css/layui.css" type="text/css">
    <link rel="stylesheet" href="/../css/font.css" type="text/css">
    <link rel="stylesheet" href="/../css/xadmin.css" type="text/css">
    <link rel="stylesheet" href="/../css/jquery.css">
    <link rel="stylesheet" href="/../css/zTreeStyle.css" type="text/css">
    <link rel="stylesheet" href="/../css/Sortable.css" type="text/css">
    <link rel="stylesheet" href="/../css/layui.css" type="text/css">
    <script type="text/javascript" async="" src="/../js/vds.js"></script>
    <script type="text/javascript" src="/../js/all_before.js"></script>
    <link rel="stylesheet" href="/../css/layer.css" id="layuicss-skinlayercss">
    <script type="text/javascript" src="/../js/highcharts.js"></script>
    <script type="text/javascript" src="/../js/exporting.js"></script>
    <script type="text/javascript" src="/../js/WdatePicker.js"></script>
    <link href="/../css/WdatePicker.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="/../js/jquery.js"></script>
    <script type="text/javascript" src="/../js/all_after.js"></script>
    <script type="text/javascript" src="/../js/flexigrid.js"></script>
    <script type="text/javascript" src="/../js/wbi_common.js"></script>
    <script type="text/javascript" src="/../js/wbill_common.js"></script>
    <script type="text/javascript" src="/../js/filter.js"></script>
    <script type="text/javascript" src="/../js/record.js"></script>
    <script type="text/javascript" src="/../js/vue/vue.min.js"></script>
    <script type="text/javascript" src="/../js/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/../js/layer/layer.js"></script>
    <script type="text/javascript" src="/../js/laypage/laypage.js"></script>
    <script type="text/javascript" src="/../lib/layui/layui.js" charset="utf-8"></script>
</head>
<body>
<div class="container">
    <form id="addPurchaseForm">
        <br/>
        <br>
        <br>
        <br>
        <br>
        <div style="margin: auto;width: 800px;height: 500px">
        <div class="layui-inline">
            <label class="layui-form-label">业务日期</label>
            <div class="layui-input-inline">
                <input type="text" name="poDate" id="date" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">单据编号</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poNumber" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-input-inline">
            <label class="layui-form-label">处理状态</label>
            <select name="quiz2">
                <option value="">默认</option>
                <option value="杭州">已审核</option>
                <option value="杭州">未审核</option>
            </select>
        </div>
        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">审核人</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poAuditor" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-input-inline">
            <label class="layui-form-label">供应商名称</label>
            <select name="quiz2">
                <option value="">默认</option>
                <option value="杭州">一号供应商</option>
                <option value="杭州">未审核</option>
            </select>
        </div>
        <br>
        <br>
        <div class="layui-input-inline">
            <label class="layui-form-label">商品名</label>
            <select name="quiz2">
                <option value="">默认</option>
                <option value="杭州">一号供应商</option>
                <option value="杭州">未审核</option>
            </select>
        </div>
        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">进货数量</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poQuantityOfPurchase" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">应付金额</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poYingMoney" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>

        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">纸质单据</label>
            <button type="button" class="layui-btn layui-btn-danger" id="poBill"><i class="layui-icon"></i>上传图片</button>
        </div>

        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">经手人</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poExperiencedPerson" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">制单人</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poSinglePerson" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">备注</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poRemarks" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-inline">
            <label class="layui-form-label">备注</label>
            <div class="layui-input-inline">
                <input type="tel" name="phone" id="poDateOrder" lay-verify="required|phone" autocomplete="off" class="layui-input">
            </div>
        </div>
        <br>
        <br>
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit="" lay-filter="demo1">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
        </div>
    </form>
</div>

<script>
    var addPurchase = function () {
        if (!check().form()) {
            return;
        }
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "/cargomanagement/purchase-order/addPurchaseGoTo",
            data: {
                "poDate": $("#poDate").val(),
                "poNumber":$("#poNumber").val(),
                "poState":$("#poState").val(),
                "poAuditor":$("#poAuditor").val(),
                "poSupName":$("#poSupName").val(),
                "poClName":$("#poClName").val(),
                "poQuantityOfPurchase":$("#poQuantityOfPurchase").val(),
                "poYingMoney":$("#poYingMoney").val(),
                "poBill":$("#poBill").val(),
                "poExperiencedPerson":$("#poExperiencedPerson").val(),
                "poSinglePerson":$("#poSinglePerson").val(),
                "poRemarks":$("#poRemarks").val(),
                "poDateOrder":$("#poDateOrder").val()
            },
            success:function (msg) {
                $("#cancelBtn").click();
            }
        });
    };

    $('#saveBtn').on('click',function () {
        addPurchase();
    });

    $('#cancelBtn').on('click',function () {
        var index = parent.layer.getFrameIndex(window.name);
        parent.getPurchasePageList();
        parent.layer.close(index);
    });

    //校验字段是否正确
    function check() {
        /*返回一个validata对象  这个对象有一个form方法返回的是是否通过验证*/
        return $("#addPurchaseForm").validate({
            rules:{
                poDate:{
                    required:true
                },
                poNumber:{
                    required:true
                },
                poState:{
                    required:true
                },
                poAuditor:{
                    required:true
                },
                poSupName:{
                    required:true
                },
                poClName:{
                    required:true
                },
                poQuantityOfPurchase:{
                    required:true
                },
                poYingMoney:{
                    required:true
                },
                poBill:{
                    required:true
                },
                poExperiencedPerson:{
                    required:true
                },
                poSinglePerson:{
                    required:true
                },
                poRemarks:{
                    required:true
                },
                poDateOrder:{
                    required:true
                }
            },
            messages:{
                poDate:{
                    required:""
                },
                poNumber:{
                    required:""
                },
                poState:{
                    required:""
                },
                poAuditor:{
                    required:""
                },
                poSupName:{
                    required:""
                },
                poClName:{
                    required:""
                },
                poQuantityOfPurchase:{
                    required:""
                },
                poYingMoney:{
                    required:""
                },
                poBill:{
                    required:""
                },
                poExperiencedPerson:{
                    required:""
                },
                poSinglePerson:{
                    required:""
                },
                poRemarks:{
                    required:""
                },
                poDateOrder:{
                    required:""
                }
            }
        });
    }

    //日期
    laydate.render({
        elem: '#date'
    });
    laydate.render({
        elem: '#date1'
    });

    upload.render({
        elem: '#poBill'
        ,url: '/upload/'
        ,size: 60 //限制文件大小，单位 KB
        ,done: function(res){
            console.log(res)
        }
    });

</script>

</body>
</html>